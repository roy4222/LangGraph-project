# é…ç½®æ–‡ä»¶æ–‡æª”

é€™å€‹è³‡æ–™å¤¾åŒ…å«æ‰€æœ‰å°ˆæ¡ˆé…ç½®æ–‡ä»¶çš„è©³ç´°èªªæ˜æ–‡æª”ã€‚

## ğŸ“ æ–‡æª”åˆ—è¡¨

### æ ¸å¿ƒé…ç½®

1. **[next.config.ts.md](./next.config.ts.md)**
   - Next.js ä¸»é…ç½®æ–‡ä»¶
   - API è·¯ç”±ä»£ç†è¨­å®š
   - CORS è¨­å®š
   - Cloudflare Pages éƒ¨ç½²é¸é …

2. **[wrangler.toml.md](./wrangler.toml.md)**
   - Cloudflare Workers é…ç½®æ–‡ä»¶
   - ç’°å¢ƒè®Šæ•¸èˆ‡ Secrets è¨­å®š
   - KV/D1 ç¶å®šèªªæ˜
   - è³‡æºé™åˆ¶è¨­å®š

### å¥—ä»¶é…ç½®

3. **[workers-package.json.md](./workers-package.json.md)**
   - Workers å°ˆæ¡ˆçš„å¥—ä»¶é…ç½®
   - ä¾è³´å¥—ä»¶èªªæ˜
   - é–‹ç™¼èˆ‡å»ºç½®è…³æœ¬

4. **[workers-tsconfig.json.md](./workers-tsconfig.json.md)**
   - Workers TypeScript é…ç½®
   - ç·¨è­¯é¸é …èªªæ˜
   - å‹åˆ¥å®šç¾©è¨­å®š

### ç’°å¢ƒè®Šæ•¸

5. **[environment-variables.md](./environment-variables.md)**
   - å®Œæ•´çš„ç’°å¢ƒè®Šæ•¸è¨­å®šæŒ‡å—
   - å‰ç«¯èˆ‡å¾Œç«¯ç’°å¢ƒè®Šæ•¸å·®ç•°
   - API Keys ç”³è«‹æ•™å­¸
   - å®‰å…¨æ€§æœ€ä½³å¯¦è¸

### é–‹ç™¼æŒ‡ä»¤

6. **[package-scripts.md](./package-scripts.md)**
   - æ‰€æœ‰ NPM Scripts èªªæ˜
   - é–‹ç™¼å·¥ä½œæµç¨‹
   - éƒ¨ç½²æµç¨‹
   - å¸¸è¦‹å•é¡Œæ’æŸ¥

---

## ğŸš€ å¿«é€Ÿå°èˆª

### æˆ‘æƒ³...

#### åˆæ¬¡è¨­å®šå°ˆæ¡ˆ
1. å…ˆçœ‹ [ç’°å¢ƒè®Šæ•¸è¨­å®š](./environment-variables.md)
2. å†çœ‹ [NPM Scripts](./package-scripts.md) äº†è§£å¦‚ä½•å•Ÿå‹•

#### ä¿®æ”¹ Next.js è¨­å®š
â†’ [next.config.ts.md](./next.config.ts.md)

#### ä¿®æ”¹ Workers è¨­å®š
â†’ [wrangler.toml.md](./wrangler.toml.md)

#### æ–°å¢å¥—ä»¶
â†’ [workers-package.json.md](./workers-package.json.md)

#### è¨­å®šç’°å¢ƒè®Šæ•¸
â†’ [environment-variables.md](./environment-variables.md)

#### äº†è§£é–‹ç™¼æŒ‡ä»¤
â†’ [package-scripts.md](./package-scripts.md)

---

## ğŸ“‚ å¯¦éš›é…ç½®æ–‡ä»¶ä½ç½®

| æ–‡æª” | å¯¦éš›é…ç½®æ–‡ä»¶ä½ç½® |
|------|----------------|
| next.config.ts.md | `/next.config.ts` |
| wrangler.toml.md | `/workers/api/wrangler.toml` |
| workers-package.json.md | `/workers/api/package.json` |
| workers-tsconfig.json.md | `/workers/api/tsconfig.json` |
| environment-variables.md | `/.env.local`, `/workers/api/.dev.vars` |
| package-scripts.md | `/package.json`, `/workers/api/package.json` |

---

## ğŸ”„ é…ç½®æ–‡ä»¶é—œä¿‚åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ ¹ç›®éŒ„                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ package.json                            â”‚   â”‚
â”‚  â”‚  - å®šç¾©å‰ç«¯è…³æœ¬èˆ‡å¥—ä»¶                    â”‚   â”‚
â”‚  â”‚  - dev, build, deploy ç­‰æŒ‡ä»¤            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ next.config.ts                          â”‚   â”‚
â”‚  â”‚  - Next.js è¨­å®š                         â”‚   â”‚
â”‚  â”‚  - API ä»£ç†åˆ° Workers                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ .env.local                              â”‚   â”‚
â”‚  â”‚  - NEXT_PUBLIC_API_URL                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ rewrites /api/* to
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              workers/api/                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ wrangler.toml                           â”‚   â”‚
â”‚  â”‚  - Workers åç¨±ã€å…¥å£æª”æ¡ˆ                â”‚   â”‚
â”‚  â”‚  - ç›¸å®¹æ€§è¨­å®š                            â”‚   â”‚
â”‚  â”‚  - CPU/Memory é™åˆ¶                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ package.json                            â”‚   â”‚
â”‚  â”‚  - Hono, LangGraph.js ç­‰å¥—ä»¶            â”‚   â”‚
â”‚  â”‚  - Workers å°ˆç”¨è…³æœ¬                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ tsconfig.json                           â”‚   â”‚
â”‚  â”‚  - Workers TypeScript è¨­å®š              â”‚   â”‚
â”‚  â”‚  - @cloudflare/workers-types            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ .dev.vars (æœ¬åœ°)                        â”‚   â”‚
â”‚  â”‚  - GROQ_API_KEY                         â”‚   â”‚
â”‚  â”‚  - OPENROUTER_API_KEY                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Secrets (ç”Ÿç”¢)                          â”‚   â”‚
â”‚  â”‚  - wrangler secret put                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶æª¢æŸ¥æ¸…å–®

### åˆæ¬¡è¨­å®š

- [ ] è¤‡è£½ `.env.local.example` â†’ `.env.local`
- [ ] è¤‡è£½ `workers/api/.dev.vars.example` â†’ `workers/api/.dev.vars`
- [ ] åœ¨ `.dev.vars` å¡«å…¥ Groq API Key
- [ ] å®‰è£å‰ç«¯å¥—ä»¶ï¼š`npm install`
- [ ] å®‰è£ Workers å¥—ä»¶ï¼š`cd workers/api && npm install`
- [ ] æ¸¬è©¦å•Ÿå‹•ï¼š`npm run dev:all`

### éƒ¨ç½²å‰

- [ ] åŸ·è¡Œ `wrangler login`
- [ ] è¨­å®š Workers Secretsï¼š`wrangler secret put GROQ_API_KEY`
- [ ] ç¢ºèª `wrangler.toml` çš„ `name` æ­£ç¢º
- [ ] ç¢ºèª `next.config.ts` çš„ `rewrites` è¨­å®šæ­£ç¢º
- [ ] å»ºç½®æ¸¬è©¦ï¼š`npm run build:all`
- [ ] éƒ¨ç½² Workersï¼š`npm run deploy:worker`
- [ ] åœ¨ Cloudflare Pages è¨­å®š `NEXT_PUBLIC_API_URL`
- [ ] éƒ¨ç½²å‰ç«¯ï¼š`npm run deploy`

---

## âš ï¸ å¸¸è¦‹éŒ¯èª¤

### æ‰¾ä¸åˆ°æ¨¡çµ„

```
Error: Cannot find module 'hono'
```

**è§£æ±º**ï¼š
```bash
cd workers/api
npm install
```

---

### ç’°å¢ƒè®Šæ•¸æœªå®šç¾©

```
Error: env.GROQ_API_KEY is undefined
```

**è§£æ±º**ï¼š
```bash
# æœ¬åœ°é–‹ç™¼
cd workers/api
cp .dev.vars.example .dev.vars
# ç·¨è¼¯ .dev.vars

# ç”Ÿç”¢ç’°å¢ƒ
wrangler secret put GROQ_API_KEY
```

---

### API è«‹æ±‚ CORS éŒ¯èª¤

```
Access to fetch has been blocked by CORS policy
```

**è§£æ±º**ï¼š
1. ç¢ºèª Workers æ˜¯å¦æ­£å¸¸é‹è¡Œï¼š`curl http://localhost:8787/api/health`
2. ç¢ºèª `next.config.ts` çš„ `rewrites` è¨­å®š
3. ç¢ºèª Workers æœ‰è¨­å®š CORS headers

---

## ğŸ”— ç›¸é—œè³‡æº

- [Cloudflare Workers å®˜æ–¹æ–‡æª”](https://developers.cloudflare.com/workers/)
- [Next.js é…ç½®æ–‡æª”](https://nextjs.org/docs/app/api-reference/config/next-config-js)
- [Wrangler CLI æ–‡æª”](https://developers.cloudflare.com/workers/wrangler/)
- [Hono æ–‡æª”](https://hono.dev/)
- [LangGraph.js æ–‡æª”](https://langchain-ai.github.io/langgraphjs/)

---

## ğŸ’¡ æç¤º

- æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½æœ‰è©³ç´°çš„è¨»è§£
- é‡åˆ°å•é¡Œå…ˆæŸ¥çœ‹å°æ‡‰çš„ `.md` æ–‡æª”
- ç’°å¢ƒè®Šæ•¸ç¯„æœ¬æª”æ¡ˆï¼ˆ`.example`ï¼‰å¯ä»¥ç›´æ¥è¤‡è£½ä½¿ç”¨
- è¨˜å¾—å®šæœŸæª¢æŸ¥å¥—ä»¶æ›´æ–°ï¼š`npm outdated`
